openapi: 3.0.0
info:
  title: Logout API
  description: Gestion des d√©connexions - session actuelle ou globale
  version: 1.0.0

paths:
  /v1/auth/logout:
    post:
      tags:
        - D√©connexion
      summary: Se d√©connecter de la session actuelle
      description: |
        D√©connecte l'utilisateur de la session actuelle uniquement en r√©voquant le token utilis√© pour cette requ√™te.
        
        **Comportement :**
        - ‚úÖ **Session actuelle ferm√©e** (ce token r√©voqu√©)
        - ‚úÖ **Autres sessions pr√©serv√©es** (autres appareils restent connect√©s)
        - ‚úÖ **D√©connexion s√©lective** par appareil
        
        **Cas d'usage :**
        - D√©connexion normale d'un appareil
        - Fermeture d'application mobile/web
        - Changement d'utilisateur sur un appareil partag√©

      security:
        - bearerAuth: []

      responses:
        '200':
          description: D√©connexion de la session actuelle r√©ussie
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "D√©connexion r√©ussie"
                  data:
                    type: object
                    properties:
                      logoutInfo:
                        type: object
                        properties:
                          userId:
                            type: string
                            example: "uuid-user-123"
                          userRole:
                            type: string
                            enum: [PATIENT, MEDECIN, ADMIN]
                            example: "PATIENT"
                          tokensRevoked:
                            type: integer
                            example: 1
                          logoutTime:
                            type: string
                            format: date-time
                            example: "2025-07-24T14:30:22.123Z"
                          ip:
                            type: string
                            example: "192.168.1.100"
                      securityInfo:
                        type: object
                        properties:
                          message:
                            type: string
                            example: "Votre session actuelle a √©t√© ferm√©e"
                          action:
                            type: string
                            example: "Vos autres sessions restent actives"
                          affectedDevices:
                            type: string
                            example: "Cet appareil uniquement"
                  timestamp:
                    type: string
                    format: date-time
                    example: "2025-07-24T14:30:22.123Z"

        '401':
          description: Token d'authentification manquant ou invalide
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "UNAUTHORIZED"
                  message:
                    type: string
                    example: "Token d'authentification invalide ou expir√©"
                  timestamp:
                    type: string
                    format: date-time
                    example: "2025-07-24T14:30:22.123Z"

        '500':
          description: Erreur interne du serveur
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "INTERNAL_ERROR"
                  message:
                    type: string
                    example: "Erreur interne lors de la d√©connexion"
                  timestamp:
                    type: string
                    format: date-time

  /v1/auth/logout/all:
    delete:
      tags:
        - D√©connexion
      summary: Se d√©connecter de toutes les sessions (d√©connexion globale)
      description: |
        D√©connecte l'utilisateur de TOUTES ses sessions actives en r√©voquant tous ses tokens (ACCESS + REFRESH).
        
        **Comportement :**
        - üî• **Toutes les sessions ferm√©es** (tous les tokens r√©voqu√©s)
        - üî• **Tous les appareils d√©connect√©s** (mobile, web, tablette, etc.)
        - üî• **D√©connexion compl√®te** et s√©curis√©e
        
        **Cas d'usage :**
        - S√©curit√© : t√©l√©phone/ordinateur vol√© ou perdu
        - Suspicion de compromission de compte
        - Changement de mot de passe (optionnel)
        - Nettoyage de toutes les sessions

      security:
        - bearerAuth: []

      responses:
        '200':
          description: D√©connexion globale r√©ussie - Toutes les sessions ferm√©es
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "D√©connexion globale r√©ussie"
                  data:
                    type: object
                    properties:
                      logoutInfo:
                        type: object
                        properties:
                          userId:
                            type: string
                            example: "uuid-user-123"
                          userRole:
                            type: string
                            enum: [PATIENT, MEDECIN, ADMIN]
                            example: "MEDECIN"
                          tokensRevoked:
                            type: integer
                            example: 5
                          logoutTime:
                            type: string
                            format: date-time
                            example: "2025-07-24T14:30:22.123Z"
                          ip:
                            type: string
                            example: "192.168.1.100"
                      securityInfo:
                        type: object
                        properties:
                          message:
                            type: string
                            example: "Tous vos tokens d'acc√®s ont √©t√© r√©voqu√©s"
                          action:
                            type: string
                            example: "Vous devez vous reconnecter pour acc√©der √† nouveau"
                          affectedDevices:
                            type: string
                            example: "Tous les appareils connect√©s"
                      nextSteps:
                        type: array
                        items:
                          type: string
                        example:
                          - "Reconnectez-vous avec vos identifiants"
                          - "Toutes vos sessions ont √©t√© ferm√©es"
                          - "Cette action am√©liore la s√©curit√© de votre compte"
                  timestamp:
                    type: string
                    format: date-time
                    example: "2025-07-24T14:30:22.123Z"

        '401':
          description: Token d'authentification manquant ou invalide
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "UNAUTHORIZED"
                  message:
                    type: string
                    example: "Token d'authentification invalide ou expir√©"
                  timestamp:
                    type: string
                    format: date-time

        '500':
          description: Erreur interne du serveur
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "INTERNAL_ERROR"
                  message:
                    type: string
                    example: "Erreur interne lors de la d√©connexion globale"
                  timestamp:
                    type: string
                    format: date-time